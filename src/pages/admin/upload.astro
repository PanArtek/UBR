---
import Layout from '../../layouts/Layout.astro';

const categories = [
  { id: 'domy-jednorodzinne', name: 'Domy jednorodzinne' },
  { id: 'mieszkania', name: 'Mieszkania' },
  { id: 'remonty-kapitalne', name: 'Remonty kapitalne' },
  { id: 'wykonczennia', name: 'Wykończenia' },
  { id: 'dachy-elewacje', name: 'Dachy i elewacje' },
  { id: 'lazienki-kuchnie', name: 'Łazienki i kuchnie' },
];
---

<Layout title="Dodaj zdjęcia" description="Panel dodawania zdjęć">
  <div class="min-h-screen bg-gray-100 py-8 px-4">
    <div class="max-w-4xl mx-auto">
      <!-- Back Button -->
      <a href="/admin" class="inline-flex items-center text-blue-600 hover:text-blue-800 mb-6">
        ← Powrót do panelu
      </a>
      
      <div class="bg-white rounded-lg shadow-lg p-6 md:p-8">
        <h1 class="text-2xl font-bold text-gray-900 mb-6">
          Dodaj nowe zdjęcia projektu
        </h1>
        
        <form class="space-y-6" id="upload-form">
          <!-- Project Name -->
          <div>
            <label class="block text-sm font-medium text-gray-700 mb-2">
              Nazwa projektu *
            </label>
            <input
              type="text"
              name="project_name"
              required
              class="w-full px-4 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500"
              placeholder="np. Dom jednorodzinny - Warszawa"
            />
          </div>
          
          <!-- Category -->
          <div>
            <label class="block text-sm font-medium text-gray-700 mb-2">
              Kategoria *
            </label>
            <select
              name="category"
              required
              class="w-full px-4 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500"
            >
              <option value="">Wybierz kategorię</option>
              {categories.map((cat) => (
                <option value={cat.id}>{cat.name}</option>
              ))}
            </select>
          </div>
          
          <!-- Description -->
          <div>
            <label class="block text-sm font-medium text-gray-700 mb-2">
              Opis projektu
            </label>
            <textarea
              name="description"
              rows="3"
              class="w-full px-4 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500 resize-none"
              placeholder="Krótki opis projektu..."
            ></textarea>
          </div>
          
          <!-- Before/After Toggle -->
          <div>
            <label class="flex items-center">
              <input
                type="checkbox"
                name="is_renovation"
                class="mr-2 h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"
              />
              <span class="text-sm text-gray-700">
                To jest projekt renowacji (przed/po)
              </span>
            </label>
          </div>
          
          <!-- File Upload -->
          <div>
            <label class="block text-sm font-medium text-gray-700 mb-2">
              Zdjęcia *
            </label>
            <div class="border-2 border-dashed border-gray-300 rounded-lg p-6 text-center hover:border-blue-400 transition-colors">
              <input
                type="file"
                name="photos"
                multiple
                accept="image/*"
                class="hidden"
                id="photo-input"
              />
              <label for="photo-input" class="cursor-pointer">
                <svg class="mx-auto h-12 w-12 text-gray-400" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12" />
                </svg>
                <p class="mt-2 text-sm text-gray-600">
                  Kliknij aby wybrać zdjęcia lub przeciągnij je tutaj
                </p>
                <p class="text-xs text-gray-500 mt-1">
                  PNG, JPG do 10MB każde
                </p>
              </label>
            </div>
            
            <!-- Preview Area -->
            <div id="preview-area" class="grid grid-cols-2 md:grid-cols-4 gap-4 mt-4"></div>
          </div>
          
          <!-- Submit Button -->
          <div class="flex justify-end space-x-4">
            <a
              href="/admin"
              class="px-6 py-2 border border-gray-300 rounded-md text-gray-700 hover:bg-gray-50 transition-colors"
            >
              Anuluj
            </a>
            <button
              type="submit"
              class="px-6 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 transition-colors font-medium"
            >
              Dodaj zdjęcia
            </button>
          </div>
        </form>
      </div>
    </div>
  </div>

  <script>
    // File upload preview
    const photoInput = document.getElementById('photo-input') as HTMLInputElement;
    const previewArea = document.getElementById('preview-area');
    
    photoInput?.addEventListener('change', (e) => {
      const files = (e.target as HTMLInputElement).files;
      if (!files) return;
      
      previewArea!.innerHTML = '';
      
      Array.from(files).forEach((file) => {
        if (!file.type.startsWith('image/')) return;
        
        const reader = new FileReader();
        reader.onload = (e) => {
          const preview = document.createElement('div');
          preview.className = 'relative group';
          preview.innerHTML = `
            <img src="${e.target?.result}" class="w-full h-24 object-cover rounded" />
            <button type="button" class="absolute top-1 right-1 bg-red-500 text-white p-1 rounded opacity-0 group-hover:opacity-100 transition-opacity">
              <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" />
              </svg>
            </button>
          `;
          previewArea?.appendChild(preview);
        };
        reader.readAsDataURL(file);
      });
    });
    
    // Form submission
    const form = document.getElementById('upload-form');
    form?.addEventListener('submit', (e) => {
      e.preventDefault();
      alert('Funkcja przesyłania zdjęć będzie dostępna w przyszłej wersji');
    });
  </script>
</Layout>